<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>UniBlood Reference Creation ‚Ä¢ CellsPickMe</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="UniBlood Reference Creation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CellsPickMe</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/CellsPickMe.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/UniBlood_references.html">UniBlood Reference Creation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>UniBlood Reference Creation</h1>
                        <h4 data-toc-skip class="author">Maggie Fu</h4>
            
            <h4 data-toc-skip class="date">2025-04-14</h4>
      

      <div class="d-none name"><code>UniBlood_references.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>This readme documents the creation process of the UniBlood sorted
cell DNAme references used in the CellsPickMe R package. The package
deconvolute cellular composition of cord, pediatric, and adult blood
samples based on their DNA methylation (DNAme) profile, as measured on
Illumina methylation arrays (compatible with HM450k, EPICv1, and
EPICv2)</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ExperimentHub</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hansenlab/minfi" class="external-link">minfi</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="uniblood-references">UniBlood references<a class="anchor" aria-label="anchor" href="#uniblood-references"></a>
</h3>
<p>The UniBlood references, including UniBlood7, UniBlood13, and
UniBlood19, were generated based on combining preexisting cord blood and
adult blood-based references. By combining sorted cells‚Äô DNAme from
these two distinct developmental time points, we aimed to capture
cell-type-specific signals that account for changes in the hematopoietic
landscape. The composition of each UniBlood references is shown in Table
1.</p>
<p><strong>Table 1</strong>. Cellular composition and dataset included
for the three reference datasets we compiled in this study, UniBlood7,
UniBlood13, and UniBlood19.</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td>UniBlood7</td>
<td>UniBlood13</td>
<td>UniBlood19</td>
</tr>
<tr class="even">
<td>FlowSorted.Blood.450k (Reinius)</td>
<td>üó∏</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>FlowSorted.Blood.EPIC (IDOL)</td>
<td>üó∏</td>
<td>only monocytes, neutrophils, and NK cells</td>
<td>only monocytes, neutrophils, and NK cells</td>
</tr>
<tr class="even">
<td>FlowSorted.Blood.Extended.EPIC (Extended)</td>
<td></td>
<td>üó∏</td>
<td>üó∏</td>
</tr>
<tr class="odd">
<td>FlowSorted.CordBlood.450k (Cord)</td>
<td>üó∏</td>
<td>6 randomly selected nRBC samples</td>
<td>6 randomly selected samples for every cell type</td>
</tr>
<tr class="even">
<td>Adult and cord cell types grouped?</td>
<td>Yes</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="odd">
<td>Cell types included</td>
<td>
<strong>Seven cell types</strong>: B cells, CD4+ T cells, CD8+ T
cells, NK cells, monocytes, granulocytes, and nRBCs</td>
<td>
<strong>Thirteen cell types</strong>: na√Øve and memory B cells,
na√Øve and memory CD4+ T cells, na√Øve and memory CD8+ T cells, Tregs, NK
cells, monocytes, neutrophils, basophils, eosinophils, and nRBCs</td>
<td>
<strong>Nineteen cell types</strong>: neonatal, na√Øve, and memory B
cells, neonatal, na√Øve, and memory CD4+ T cells, neonatal, na√Øve, and
memory CD8+ T cells, adult Tregs, neonatal and adult NK cells, neonatal
and adult monocytes, neonatal granulocytes, adult neutrophils,
basophils, and eosinophils, and nRBCs</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="load-existing-reference-datasets">Load existing reference datasets<a class="anchor" aria-label="anchor" href="#load-existing-reference-datasets"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ExperimentHub/man/ExperimentHub-class.html" class="external-link">ExperimentHub</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Extended reference</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationHub/man/AnnotationHub-class.html" class="external-link">query</a></span><span class="op">(</span><span class="va">hub</span>, <span class="st">"FlowSorted.BloodExtended.EPIC"</span><span class="op">)</span>  </span>
<span><span class="va">FlowSorted.BloodExtended.EPIC</span> <span class="op">&lt;-</span> <span class="va">hub</span><span class="op">[[</span><span class="st">"EH5425"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">n</span></span>
<span><span class="va">FlowSorted.BloodExtended.EPIC</span> <span class="op">&lt;-</span> <span class="va">FlowSorted.BloodExtended.EPIC</span><span class="op">[</span>, <span class="va">FlowSorted.BloodExtended.EPIC</span><span class="op">$</span><span class="va">Sample_Group</span> <span class="op">!=</span> <span class="st">"FlowSorted.Blood.EPIC"</span><span class="op">]</span></span>
<span><span class="va">meta_1</span> <span class="op">&lt;-</span> <span class="fu">pData</span><span class="op">(</span><span class="va">FlowSorted.BloodExtended.EPIC</span><span class="op">)</span></span>
<span><span class="va">meta_1</span> <span class="op">&lt;-</span> <span class="va">meta_1</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Age"</span>, <span class="st">"CellType"</span>, <span class="st">"Ethnicity_wide"</span>, <span class="st">"purity"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">meta_1</span><span class="op">$</span><span class="va">Ref</span> <span class="op">&lt;-</span> <span class="st">"Extended"</span></span>
<span></span>
<span><span class="co">### IDOL reference</span></span>
<span><span class="va">FlowSorted.Blood.EPIC</span> <span class="op">&lt;-</span> <span class="fu">FlowSorted.Blood.EPIC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/FlowSorted.Blood.EPIC/man/libraryDataGet.html" class="external-link">libraryDataGet</a></span><span class="op">(</span><span class="st">'FlowSorted.Blood.EPIC'</span><span class="op">)</span></span>
<span><span class="va">meta_2</span> <span class="op">&lt;-</span> <span class="fu">pData</span><span class="op">(</span><span class="va">FlowSorted.Blood.EPIC</span><span class="op">)</span></span>
<span><span class="va">meta_2</span> <span class="op">&lt;-</span> <span class="va">meta_2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Age"</span>, <span class="st">"CellType"</span>, <span class="st">"Ethnicity_wide"</span>, <span class="st">"purity"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">meta_2</span><span class="op">$</span><span class="va">Ref</span> <span class="op">&lt;-</span> <span class="st">"IDOL"</span></span>
<span></span>
<span><span class="co">### Cord reference</span></span>
<span><span class="va">FlowSorted.CordBlood.450k</span> <span class="op">&lt;-</span> <span class="fu">FlowSorted.CordBloodCombined.450k</span><span class="fu">::</span><span class="fu">libraryDataGet</span><span class="op">(</span><span class="st">'FlowSorted.CordBloodCombined.450k'</span><span class="op">)</span></span>
<span><span class="va">meta_3</span> <span class="op">&lt;-</span> <span class="fu">pData</span><span class="op">(</span><span class="va">FlowSorted.CordBlood.450k</span><span class="op">)</span></span>
<span><span class="va">meta_3</span> <span class="op">&lt;-</span> <span class="va">meta_3</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Age"</span>, <span class="st">"CellType"</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">.</span>, Ethnicity_wide <span class="op">=</span> <span class="cn">NA</span>, purity <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">meta_3</span><span class="op">$</span><span class="va">Ref</span> <span class="op">&lt;-</span> <span class="st">"Cord"</span></span>
<span></span>
<span><span class="co">### Reinius</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FlowSorted.Blood.450k</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"FlowSorted.Blood.450k"</span><span class="op">)</span></span>
<span><span class="va">meta_4</span> <span class="op">&lt;-</span> <span class="fu">pData</span><span class="op">(</span><span class="va">FlowSorted.Blood.450k</span><span class="op">)</span></span>
<span><span class="va">meta_4</span> <span class="op">&lt;-</span> <span class="va">meta_4</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"CellType"</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">.</span>, Age <span class="op">=</span> <span class="cn">NA</span>, Ethnicity_wide <span class="op">=</span> <span class="cn">NA</span>, purity <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">meta_4</span><span class="op">$</span><span class="va">Ref</span> <span class="op">&lt;-</span> <span class="st">"Reinius"</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="uniblood7">UniBlood7<a class="anchor" aria-label="anchor" href="#uniblood7"></a>
</h3>
<p>UniBlood7 includes the Reinius, Cord, and IDOL references. With only
7 cell types, the reference treat neonatal and adult cells of the same
identity (e.g.¬†CD4T cells) as one cell type.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ref_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">meta_2</span>, <span class="va">meta_3</span>, <span class="va">meta_4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine reference datasets</span></span>
<span><span class="va">UniBlood7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/minfi/man/combineArrays.html" class="external-link">combineArrays</a></span><span class="op">(</span><span class="va">FlowSorted.Blood.450k</span>, </span>
<span>                           <span class="va">FlowSorted.Blood.EPIC</span>, </span>
<span>                           outType <span class="op">=</span> <span class="st">"IlluminaHumanMethylation450k"</span><span class="op">)</span></span>
<span><span class="va">UniBlood7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/minfi/man/combineArrays.html" class="external-link">combineArrays</a></span><span class="op">(</span><span class="va">UniBlood7</span>, </span>
<span>                           <span class="va">FlowSorted.CordBlood.450k</span>, </span>
<span>                           outType <span class="op">=</span> <span class="st">"IlluminaHumanMethylation450k"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UniBlood7_meta</span> <span class="op">&lt;-</span> <span class="va">Ref_meta</span><span class="op">[</span><span class="fu">sampleNames</span><span class="op">(</span><span class="va">UniBlood7</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu">pData</span><span class="op">(</span><span class="va">UniBlood7</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">UniBlood7_meta</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">UniBlood7</span>, compression_level <span class="op">=</span> <span class="fl">9</span>, file <span class="op">=</span> <span class="st">"data/UniBlood7.rda"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="uniblood13">UniBlood13<a class="anchor" aria-label="anchor" href="#uniblood13"></a>
</h3>
<p>UniBlood13 is mostly built on the Extended reference, with additional
samples from the IDOL reference and nRBCs from the Cord reference. With
13 cell types, the reference assumes that neonatal and adult cells share
similar DNAme profiles except for the nRBCs, which only exist at the
neonatal time point.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ref_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">meta_1</span>, <span class="va">meta_2</span>, <span class="va">meta_3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select samples to exclude from cord blood samples based on odd clustering from PCA</span></span>
<span><span class="va">samp_IDOL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">meta_2</span><span class="op">)</span><span class="op">[</span><span class="va">meta_2</span><span class="op">$</span><span class="va">CellType</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mono"</span>, <span class="st">"Neu"</span>, <span class="st">"NK"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">samp_Extended</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">meta_1</span><span class="op">)</span><span class="op">[</span><span class="va">meta_1</span><span class="op">$</span><span class="va">CellType</span> <span class="op">!=</span> <span class="st">"MIX"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">FlowSorted.CordBlood.nRBC</span> <span class="op">&lt;-</span> <span class="va">FlowSorted.CordBlood.450k</span><span class="op">[</span>, <span class="va">meta_3</span><span class="op">$</span><span class="va">CellType</span> <span class="op">==</span> <span class="st">"nRBC"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Combine reference datasets</span></span>
<span><span class="va">UniBlood13</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/minfi/man/combineArrays.html" class="external-link">combineArrays</a></span><span class="op">(</span><span class="va">FlowSorted.BloodExtended.EPIC</span><span class="op">[</span>, <span class="va">samp_Extended</span><span class="op">]</span>, </span>
<span>                            <span class="va">FlowSorted.Blood.EPIC</span><span class="op">[</span>, <span class="va">samp_IDOL</span><span class="op">]</span>, </span>
<span>                            outType <span class="op">=</span> <span class="st">"IlluminaHumanMethylationEPIC"</span><span class="op">)</span></span>
<span><span class="va">UniBlood13</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/minfi/man/combineArrays.html" class="external-link">combineArrays</a></span><span class="op">(</span><span class="va">UniBlood13</span>, </span>
<span>                            <span class="va">FlowSorted.CordBlood.nRBC</span>, </span>
<span>                            outType <span class="op">=</span> <span class="st">"IlluminaHumanMethylation450k"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UniBlood13_meta</span> <span class="op">&lt;-</span> <span class="va">Ref_meta</span><span class="op">[</span><span class="fu">sampleNames</span><span class="op">(</span><span class="va">UniBlood13</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu">pData</span><span class="op">(</span><span class="va">UniBlood13</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">UniBlood13_meta</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">UniBlood13</span>, compression_level <span class="op">=</span> <span class="fl">9</span>, file <span class="op">=</span> <span class="st">"data/UniBlood13.rda"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="uniblood19">UniBlood19<a class="anchor" aria-label="anchor" href="#uniblood19"></a>
</h3>
<p>Finally, UniBlood19 is the reference with the most cell types. It
combines reference datasets from Extended, Cord, and IDOL. The reference
treated neonatal and adult cells as distinct identities, with the cord
blood cells labelled with the ‚Äú_cord‚Äù suffix.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ref_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">meta_1</span>, <span class="va">meta_2</span>, <span class="va">meta_3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select samples to exclude from cord blood samples based on odd clustering from PCA</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X3999492113_R01C01"</span>, </span>
<span>         <span class="st">"X3999492113_R06C02"</span>, </span>
<span>         <span class="st">"X3999997142_R02C02"</span>, </span>
<span>         <span class="st">"X3999984059_R01C02"</span>, </span>
<span>         <span class="st">"X3999492043_R06C01"</span>, </span>
<span>         <span class="st">"X3999984058_R06C01"</span>, </span>
<span>         <span class="st">"X201868590206_R06C01"</span>, </span>
<span>         <span class="st">"3999492043_R06C01"</span>, </span>
<span>         <span class="st">"3999984058_R06C01"</span>, </span>
<span>         <span class="st">"200705360101_R04C01"</span>, </span>
<span>         <span class="st">"Gran_4"</span>, </span>
<span>         <span class="st">"Gran_5"</span>, </span>
<span>         <span class="st">"200705360089_R06C01"</span>, </span>
<span>         <span class="st">"200705360058_R07C01"</span>, </span>
<span>         <span class="st">"200693480131_R02C01"</span>, </span>
<span>         <span class="st">"3999984059_R04C02"</span>, </span>
<span>         <span class="st">"200705360013_R06C01"</span>, </span>
<span>         <span class="st">"200705360068_R02C01"</span>, </span>
<span>         <span class="st">"3999492113_R01C01"</span>, </span>
<span>         <span class="st">"CD8+_6"</span>, </span>
<span>         <span class="st">"200705360060_R06C01"</span>, </span>
<span>         <span class="st">"3999997142_R03C01"</span>,</span>
<span>         <span class="st">"200693480078_R02C01"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Ref_meta</span> <span class="op">&lt;-</span> <span class="va">Ref_meta</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Ref_meta</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">out</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">samp_Cord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD4T"</span>, <span class="st">"NK"</span>, <span class="st">"nRBC"</span>, <span class="st">"Bcell"</span>, <span class="st">"Mono"</span>, <span class="st">"Gran"</span>, <span class="st">"CD8T"</span>, <span class="st">"WBC"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Ref_meta</span><span class="op">)</span><span class="op">[</span><span class="va">Ref_meta</span><span class="op">$</span><span class="va">CellType</span> <span class="op">==</span> <span class="va">x</span> <span class="op">&amp;</span> <span class="va">Ref_meta</span><span class="op">$</span><span class="va">Ref</span> <span class="op">==</span> <span class="st">"Cord"</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">samp_IDOL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">meta_2</span><span class="op">)</span><span class="op">[</span><span class="va">meta_2</span><span class="op">$</span><span class="va">CellType</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mono"</span>, <span class="st">"Neu"</span>, <span class="st">"NK"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">samp_Extended</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">meta_1</span><span class="op">)</span><span class="co">#[meta_1$CellType != "MIX"]</span></span>
<span></span>
<span><span class="co"># Rename cord blood cells</span></span>
<span><span class="va">Ref_meta</span><span class="op">$</span><span class="va">CellType</span><span class="op">[</span><span class="va">Ref_meta</span><span class="op">$</span><span class="va">Ref</span> <span class="op">==</span> <span class="st">"Cord"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Ref_meta</span><span class="op">$</span><span class="va">CellType</span><span class="op">[</span><span class="va">Ref_meta</span><span class="op">$</span><span class="va">Ref</span> <span class="op">==</span> <span class="st">"Cord"</span><span class="op">]</span>, <span class="st">"_cord"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"nRBC_cord"</span>, <span class="st">"nRBC"</span>, <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine reference datasets</span></span>
<span><span class="va">UniBlood19</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/minfi/man/combineArrays.html" class="external-link">combineArrays</a></span><span class="op">(</span><span class="va">FlowSorted.BloodExtended.EPIC</span><span class="op">[</span>, <span class="va">samp_Extended</span><span class="op">]</span>, </span>
<span>                            <span class="va">FlowSorted.Blood.EPIC</span><span class="op">[</span>, <span class="va">samp_IDOL</span><span class="op">]</span>, </span>
<span>                            outType <span class="op">=</span> <span class="st">"IlluminaHumanMethylationEPIC"</span><span class="op">)</span></span>
<span><span class="va">UniBlood19</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/minfi/man/combineArrays.html" class="external-link">combineArrays</a></span><span class="op">(</span><span class="va">UniBlood19</span>, </span>
<span>                            <span class="va">FlowSorted.CordBlood.450k</span><span class="op">[</span>, <span class="va">samp_Cord</span><span class="op">]</span>, </span>
<span>                            outType <span class="op">=</span> <span class="st">"IlluminaHumanMethylation450k"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UniBlood19_meta</span> <span class="op">&lt;-</span> <span class="va">Ref_meta</span><span class="op">[</span><span class="fu">sampleNames</span><span class="op">(</span><span class="va">UniBlood19</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu">pData</span><span class="op">(</span><span class="va">UniBlood19</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">UniBlood19_meta</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">UniBlood19</span>, compression_level <span class="op">=</span> <span class="fl">9</span>, file <span class="op">=</span> <span class="st">"data/UniBlood19.rda"</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maggie Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
